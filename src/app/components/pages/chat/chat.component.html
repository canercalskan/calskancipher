<div class="wrapper">
    <div style="max-width: 100vw;">
            <chat-navbar></chat-navbar>
        <div class="content">
            <div class="active-users-sidebar">
                <active-users></active-users>
            </div>
            <div id="chat-session">

                <div class="profile text-white" *ngIf="!displaySession">
                    <div class="flex">
                        <i class="bi bi-person-circle" id="profile-icon"></i>
                    </div>
                    <form #uploadPictureForm = 'ngForm' (submit) = 'uploadImage()' ngNativeValidate>
                        <div class="d-flex">
                            <input type="file" name="picture" class="form-control" (change) = 'handleImageSelection($event)' ngModel required>
                            <button type="submit">Upload</button>
                        </div>
                    </form>
                    <div class="uploading" *ngIf="showUploading">
                        <div class="dot1 bg-success rounded-circle m-2">
                        </div>
                        <div class="dot2 bg-success rounded-circle m-2">
                        </div>
                        <div class="dot3 bg-success rounded-circle m-2"></div>
                    </div>
                    <hr>
                </div>
                

                <div class="preferences text-white" *ngIf="!displaySession">
                    <h2 class="text-center">Preferences</h2>
                    <div class="options">
                    <p class="ms-3">
                        Get a new message notification
                         <span>
                            <input type="checkbox">
                         </span>
                    </p>
                   
                   <p class="ms-3">
                    Allow..
                        <span class="d-block ps-4">
                            Only the person i am chatting with
                            <input type="checkbox">
                        </span>
                        <span class="d-block ps-4">
                            Anyone
                            <input type="checkbox">
                        </span>
                        <span class="d-block ps-4">
                            No one
                            <input type="checkbox">
                        </span>
                    to see my profile picture
                   </p>
                    </div>
                </div>
                
                <!-- Eğer session init edilmemişse, ortadaki boş alana kullanıcı profil işlemleri ekle -->
                <!-- Anonim profil image gözüksün, altında update PP olsun -->
                <!-- Status belirleme olsun wpdeki gibi -->

                <div class="session-navbar text-white" *ngIf="displaySession">
                    <span><i class="bi bi-person fs-4 p-2" style="border:1px solid #EC6600; border-radius: 15rem; color: #EC6600;"></i></span>
                    <span class=" ms-3" *ngIf="displaySession">{{endUserName}}</span>
                    <i class="dd bi bi-three-dots float-end text-white fs-5" id="session-actions">
                        <input type="checkbox">
                        <div class="dd-c">
                            <ul>
                                <li (click) = 'deleteConversation(displaySession)'>Delete Conversation</li>
                                <li (click) = 'blockUser(displaySession)'>Block User</li>
                            </ul>
                        </div>
                    </i>
                </div>

                <ul class="chat-field text-white" *ngIf="displaySession && displaySession.conversation">
                    <li class="d-flex" *ngFor="let message of displaySession.conversation">
                        <span [ngClass]= "{'first-user' : message.sender.uid === currentUserUid , 'end-user' : message.sender.uid != currentUserUid}">
                            {{message.content}}
                            <span class="message-time">{{message.time}}</span>
                        </span>
                    </li>
                </ul>

                <form *ngIf="displaySession" #messageForm = 'ngForm' id="messageForm" (submit) = 'sendMessage(messageForm.value); messageForm.resetForm()' ngForm ngNativeValidate>
                    <input type="text" name="content" id="content" placeholder="Type a message..." ngModel required> 
                    <button type="submit">
                        <i class="bi bi-send d-inline"></i>
                    </button>
                </form>
                
            </div>
        </div>
    </div>
</div>